<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>지붕위 테니스 클럽 친선전</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 20px;
      font-size: 16px;
      background-color: #F5F5F5;
    }
    h1, h2 {
      text-align: center;
      color: #2E7D32;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      border: none;
      display: block;
      overflow-x: auto;
      white-space: nowrap;
    }
    th, td {
      border: 1px solid #B0BEC5;
      padding: 10px;
      text-align: center;
      min-width: 80px;
    }
    th {
      background-color: #2E7D32;
      color: white;
      position: sticky;
      top: 0;
      z-index: 2;
    }
    th:first-child, td:first-child {
      position: sticky;
      left: 0;
      background-color: #E8F5E9;
      z-index: 1;
      min-width: 60px;
      border-right: 2px solid #B0BEC5;
      box-shadow: 3px 0 5px rgba(0,0,0,0.1);
    }
    th:first-child {
      background-color: #2E7D32;
      color: white;
      z-index: 3;
    }
    .men-doubles-table th, .men-doubles-table td,
    .women-doubles-table th, .women-doubles-table td {
      font-size: 24px;
      padding: 20px;
    }
    .score-input-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 5px;
      position: relative;
    }
    input[type="number"] {
      width: 35px;
      text-align: center;
      border: 1px solid #B0BEC5;
      border-radius: 3px;
      padding: 2px;
    }
    .match-pair.highlight {
      background-color: #AEEA00;
      color: #1B5E20;
      font-weight: bold;
      font-size: 15px;
      padding: 2px 5px;
      border-radius: 3px;
    }
    .player-name {
      cursor: pointer;
    }
    .completed {
      color: #2E7D32;
      font-size: 12px;
      margin-top: 5px;
      display: block;
    }
    .loading-feedback {
      position: absolute;
      bottom: -20px;
      font-size: 12px;
      color: #2E7D32;
      display: none;
    }
    .filter-button {
      display: block;
      margin: 10px auto;
      padding: 8px 16px;
      background-color: #2E7D32;
      color: white;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      font-size: 14px;
    }
    .filter-button:hover {
      background-color: #1B5E20;
    }
    .hidden {
      display: none;
    }
    @media (max-width: 768px) {
      body {
        margin: 10px;
        font-size: 13px;
      }
      table {
        font-size: 13px;
      }
      th, td {
        padding: 5px;
        min-width: 60px;
      }
      th:first-child, td:first-child {
        min-width: 50px;
      }
      .men-doubles-table th, .men-doubles-table td,
      .women-doubles-table th, .women-doubles-table td {
        font-size: 16px;
        padding: 10px;
      }
      input[type="number"] {
        width: 25px;
        font-size: 12px;
        padding: 1px;
      }
      h1 {
        font-size: 18px;
      }
      h2 {
        font-size: 14px;
      }
      ul li {
        font-size: 13px;
      }
      .match-pair.highlight {
        font-size: 13px;
      }
      .filter-button {
        font-size: 11px;
        padding: 5px 10px;
      }
    }
  </style>
</head>
<body>
  <h1>지붕위 테니스 클럽 친선전 스케줄 및 개인 순위표</h1>
  <h2>2025년 6월 7일</h2>

  <h2>대회 정보</h2>
  <ul>
    <li><strong>날짜:</strong> 2025년 6월 7일 토요일</li>
    <li><strong>시간:</strong> 오후 6:00 ~ 오후 9:45</li>
    <li><strong>경기 형식:</strong> 1세트, 6게임제, 노애드 스코어링, 경기당 25분</li>
    <li><strong>코트:</strong> 6:00~8:00: 3, 4, 5, 6, 7, 8번 / 8:05~9:45: 4, 5, 6번</li>
  </ul>

  <h2>여자 복식 정보</h2>
  <ul>
    <li><strong>참가자:</strong> 김나경, 김유하, 이은지, 이지화, 김지원, 남정주, 최창민</li>
    <li><strong>형식:</strong> 1인당 4경기, 총 7경기, 시간대별 분산, 6번 코트 고정 (단, 6:25~6:50은 남자 복식 사용)</li>
  </ul>

  <h2>남자 복식 정보</h2>
  <ul>
    <li><strong>참가자:</strong> 정수현, 권혁이, 박상원, @기훈, 김석준, 이범주, 백건재, 안종현, 김수동, 노민영, 전우식, 강동혁, 강기훈, 정래민, 정현두, 최준호, 김정보, 지민석, 상우, 김명수, 김덕헌</li>
    <li><strong>형식:</strong> 1인당 4~5경기, 총 23경기, 티어 균형, 시간대 분산</li>
  </ul>

  <h2>참고</h2>
  <ul>
    <li>코트 외: 30경기 (여자 7경기, 남자 23경기) 기록만</li>
    <li>순위는 승리 게임 수, 게임득실 순으로 결정 (게임득실 = 획득 게임 - 실점 게임)</li>
    <li>티어: 팀 티어 합 균등 배치</li>
  </ul>

  <button class="filter-button hidden" id="clear-filter">선수 필터 해제</button>

  <h2>스케줄 (6:00~8:05)</h2>
  <table id="schedule-table-1">
    <thead>
      <tr>
        <th>시간</th>
        <th>3번 코트</th>
        <th>4번 코트</th>
        <th>5번 코트</th>
        <th>6번 코트</th>
        <th>7번 코트</th>
        <th>8번 코트</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>6:00~6:25</td>
        <td><span class="match-pair">최준호&@기훈 vs 정수현&김석준</span><br><div class="score-input-container"><input type="number" id="score-600-3-team1" min="0" max="6" value="0"> : <input type="number" id="score-600-3-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-600-3"></span></div><span id="completed-600-3" class="completed"></span></td>
        <td><span class="match-pair">권혁이&김명수 vs 백건재&강기훈</span><br><div class="score-input-container"><input type="number" id="score-600-4-team1" min="0" max="6" value="0"> : <input type="number" id="score-600-4-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-600-4"></span></div><span id="completed-600-4" class="completed"></span></td>
        <td>-</td>
        <td><span class="match-pair">김나경&김유하 vs 이은지&이지화</span><br><div class="score-input-container"><input type="number" id="score-600-6-team1" min="0" max="6" value="0"> : <input type="number" id="score-600-6-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-600-6"></span></div><span id="completed-600-6" class="completed"></span></td>
        <td>-</td>
        <td><span class="match-pair">상우&안종현 vs 지민석&김정보</span><br><div class="score-input-container"><input type="number" id="score-600-8-team1" min="0" max="6" value="0"> : <input type="number" id="score-600-8-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-600-8"></span></div><span id="completed-600-8" class="completed"></span></td>
      </tr>
      <tr>
        <td>6:25~6:50</td>
        <td><span class="match-pair">김명수&안종현 vs 강기훈&김수동</span><br><div class="score-input-container"><input type="number" id="score-625-3-team1" min="0" max="6" value="0"> : <input type="number" id="score-625-3-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-625-3"></span></div><span id="completed-625-3" class="completed"></span></td>
        <td>-</td>
        <td><span class="match-pair">권혁이&지민석 vs 백건재&상우</span><br><div class="score-input-container"><input type="number" id="score-625-5-team1" min="0" max="6" value="0"> : <input type="number" id="score-625-5-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-625-5"></span></div><span id="completed-625-5" class="completed"></span></td>
        <td><span class="match-pair">박상원&이범주 vs 정래민&강동혁</span><br><div class="score-input-container"><input type="number" id="score-625-6-team1" min="0" max="6" value="0"> : <input type="number" id="score-625-6-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-625-6"></span></div><span id="completed-625-6" class="completed"></span></td>
        <td><span class="match-pair">정수현&김석준 vs 전우식&최준호</span><br><div class="score-input-container"><input type="number" id="score-625-7-team1" min="0" max="6" value="0"> : <input type="number" id="score-625-7-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-625-7"></span></div><span id="completed-625-7" class="completed"></span></td>
        <td><span class="match-pair">김덕헌&@기훈 vs 김정보&노민영</span><br><div class="score-input-container"><input type="number" id="score-625-8-team1" min="0" max="6" value="0"> : <input type="number" id="score-625-8-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-625-8"></span></div><span id="completed-625-8" class="completed"></span></td>
      </tr>
      <tr>
        <td>6:50~7:15</td>
        <td>-</td>
        <td><span class="match-pair">박상원&정현두 vs 정래민&백건재</span><br><div class="score-input-container"><input type="number" id="score-650-4-team1" min="0" max="6" value="0"> : <input type="number" id="score-650-4-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-650-4"></span></div><span id="completed-650-4" class="completed"></span></td>
        <td><span class="match-pair">@기훈&강기훈 vs 지민석&이범주</span><br><div class="score-input-container"><input type="number" id="score-650-5-team1" min="0" max="6" value="0"> : <input type="number" id="score-650-5-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-650-5"></span></div><span id="completed-650-5" class="completed"></span></td>
        <td><span class="match-pair">이은지&남정주 vs 김유하&최창민</span><br><div class="score-input-container"><input type="number" id="score-650-6-team1" min="0" max="6" value="0"> : <input type="number" id="score-650-6-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-650-6"></span></div><span id="completed-650-6" class="completed"></span></td>
        <td><span class="match-pair">김수동&전우식 vs 강동혁&노민영</span><br><div class="score-input-container"><input type="number" id="score-650-7-team1" min="0" max="6" value="0"> : <input type="number" id="score-650-7-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-650-7"></span></div><span id="completed-650-7" class="completed"></span></td>
        <td><span class="match-pair">김덕헌&상우 vs 김정보&김명수</span><br><div class="score-input-container"><input type="number" id="score-650-8-team1" min="0" max="6" value="0"> : <input type="number" id="score-650-8-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-650-8"></span></div><span id="completed-650-8" class="completed"></span></td>
      </tr>
      <tr>
        <td>7:15~7:40</td>
        <td><span class="match-pair">김정보&백건재 vs 지민석&최준호</span><br><div class="score-input-container"><input type="number" id="score-715-3-team1" min="0" max="6" value="0"> : <input type="number" id="score-715-3-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-715-3"></span></div><span id="completed-715-3" class="completed"></span></td>
        <td>-</td>
        <td><span class="match-pair">정래민&박상원 vs 강동혁&안종현</span><br><div class="score-input-container"><input type="number" id="score-715-5-team1" min="0" max="6" value="0"> : <input type="number" id="score-715-5-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-715-5"></span></div><span id="completed-715-5" class="completed"></span></td>
        <td>-</td>
        <td><span class="match-pair">김석준&@기훈 vs 정수현&권혁이</span><br><div class="score-input-container"><input type="number" id="score-715-7-team1" min="0" max="6" value="0"> : <input type="number" id="score-715-7-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-715-7"></span></div><span id="completed-715-7" class="completed"></span></td>
        <td><span class="match-pair">이범주&김덕헌 vs 전우식&정현두</span><br><div class="score-input-container"><input type="number" id="score-715-8-team1" min="0" max="6" value="0"> : <input type="number" id="score-715-8-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-715-8"></span></div><span id="completed-715-8" class="completed"></span></td>
      </tr>
      <tr>
        <td>7:40~8:05</td>
        <td><span class="match-pair">김명수&정수현 vs 강동혁&김수동</span><br><div class="score-input-container"><input type="number" id="score-740-3-team1" min="0" max="6" value="0"> : <input type="number" id="score-740-3-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-740-3"></span></div><span id="completed-740-3" class="completed"></span></td>
        <td><span class="match-pair">권혁이&정현두 vs 전우식&노민영</span><br><div class="score-input-container"><input type="number" id="score-740-4-team1" min="0" max="6" value="0"> : <input type="number" id="score-740-4-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-740-4"></span></div><span id="completed-740-4" class="completed"></span></td>
        <td>-</td>
        <td><span class="match-pair">김나경&이지화 vs 김유하&최창민</span><br><div class="score-input-container"><input type="number" id="score-740-6-team1" min="0" max="6" value="0"> : <input type="number" id="score-740-6-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-740-6"></span></div><span id="completed-740-6" class="completed"></span></td>
        <td><span class="match-pair">최준호&정래민 vs 박상원&강기훈</span><br><div class="score-input-container"><input type="number" id="score-740-7-team1" min="0" max="6" value="0"> : <input type="number" id="score-740-7-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-740-7"></span></div><span id="completed-740-7" class="completed"></span></td>
        <td>-</td>
      </tr>
    </tbody>
  </table>

  <h2>스케줄 (8:05~9:45)</h2>
  <table id="schedule-table-2">
    <thead>
      <tr>
        <th>시간</th>
        <th>4번 코트</th>
        <th>5번 코트</th>
        <th>6번 코트</th>
        <th>7번 코트</th>
        <th>8번 코트</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>8:05~8:30</td>
        <td><span class="match-pair">정현두&강기훈 vs 노민영&전우식</span><br><div class="score-input-container"><input type="number" id="score-805-4-team1" min="0" max="6" value="0"> : <input type="number" id="score-805-4-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-805-4"></span></div><span id="completed-805-4" class="completed"></span></td>
        <td><span class="match-pair">정래민&상우 vs 안종현&지민석</span><br><div class="score-input-container"><input type="number" id="score-805-5-team1" min="0" max="6" value="0"> : <input type="number" id="score-805-5-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-805-5"></span></div><span id="completed-805-5" class="completed"></span></td>
        <td><span class="match-pair">김지원&이은지 vs 이지화&최창민</span><br><div class="score-input-container"><input type="number" id="score-805-6-team1" min="0" max="6" value="0"> : <input type="number" id="score-805-6-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-805-6"></span></div><span id="completed-805-6" class="completed"></span></td>
        <td>-</td>
        <td>-</td>
      </tr>
      <tr>
        <td>8:30~8:55</td>
        <td><span class="match-pair">강동혁&김덕헌 vs 상우&@기훈</span><br><div class="score-input-container"><input type="number" id="score-830-4-team1" min="0" max="6" value="0"> : <input type="number" id="score-830-4-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-830-4"></span></div><span id="completed-830-4" class="completed"></span></td>
        <td><span class="match-pair">권혁이&정수현 vs 정현두&노민영</span><br><div class="score-input-container"><input type="number" id="score-830-5-team1" min="0" max="6" value="0"> : <input type="number" id="score-830-5-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-830-5"></span></div><span id="completed-830-5" class="completed"></span></td>
        <td><span class="match-pair">김지원&김나경 vs 남정주&최창민</span><br><div class="score-input-container"><input type="number" id="score-830-6-team1" min="0" max="6" value="0"> : <input type="number" id="score-830-6-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-830-6"></span></div><span id="completed-830-6" class="completed"></span></td>
        <td>-</td>
        <td>-</td>
      </tr>
      <tr>
        <td>8:55~9:20</td>
        <td><span class="match-pair">김석준&김명수 vs 안종현&김정보</span><br><div class="score-input-container"><input type="number" id="score-855-4-team1" min="0" max="6" value="0"> : <input type="number" id="score-855-4-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-855-4"></span></div><span id="completed-855-4" class="completed"></span></td>
        <td><span class="match-pair">이범주&최준호 vs 김덕헌&김수동</span><br><div class="score-input-container"><input type="number" id="score-855-5-team1" min="0" max="6" value="0"> : <input type="number" id="score-855-5-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-855-5"></span></div><span id="completed-855-5" class="completed"></span></td>
        <td><span class="match-pair">김지원&이은지 vs 이지화&남정주</span><br><div class="score-input-container"><input type="number" id="score-855-6-team1" min="0" max="6" value="0"> : <input type="number" id="score-855-6-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-855-6"></span></div><span id="completed-855-6" class="completed"></span></td>
        <td>-</td>
        <td>-</td>
      </tr>
      <tr>
        <td>9:20~9:45</td>
        <td><span class="match-pair">박상원&이범주 vs 백건재&김석준</span><br><div class="score-input-container"><input type="number" id="score-920-4-team1" min="0" max="6" value="0"> : <input type="number" id="score-920-4-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-920-4"></span></div><span id="completed-920-4" class="completed"></span></td>
        <td>-</td>
        <td><span class="match-pair">김지원&김유하 vs 김나경&남정주</span><br><div class="score-input-container"><input type="number" id="score-920-6-team1" min="0" max="6" value="0"> : <input type="number" id="score-920-6-team2" min="0" max="6" value="0"><span class="loading-feedback" id="loading-920-6"></span></div><span id="completed-920-6" class="completed"></span></td>
        <td>-</td>
        <td>-</td>
      </tr>
    </tbody>
  </table>

  <h2>남자 복식 순위표</h2>
  <table class="men-doubles-table">
    <thead>
      <tr>
        <th>순위</th>
        <th>선수</th>
        <th>승</th>
        <th>패</th>
        <th>게임득실</th>
      </tr>
    </thead>
    <tbody id="men-doubles-rankings">
      <!-- 동적으로 생성 -->
    </tbody>
  </table>

  <h2>여자 복식 순위표</h2>
  <table class="women-doubles-table">
    <thead>
      <tr>
        <th>순위</th>
        <th>선수</th>
        <th>승</th>
        <th>패</th>
        <th>게임득실</th>
      </tr>
    </thead>
    <tbody id="women-doubles-rankings">
      <!-- 동적으로 생성 -->
    </tbody>
  </table>

  <!-- Firebase SDK 추가 -->
  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore-compat.js"></script>
  <script>
    // Firebase 설정
    const firebaseConfig = {
      apiKey: "AIzaSyAlcszFYMqJjaJQHajx7K695zoeRS7PsxU",
      authDomain: "tennis-plan-jibung.firebaseapp.com",
      databaseURL: "https://tennis-plan-jibung-default-rtdb.firebaseio.com",
      projectId: "tennis-plan-jibung",
      storageBucket: "tennis-plan-jibung.firebasestorage.app",
      messagingSenderId: "491083537160",
      appId: "1:491083537160:web:0c2ec53b1285aa1cdc6abd",
      measurementId: "G-4CSJLPFJD6"
    };

    // Firebase 초기화
    let app, db;
    try {
      app = firebase.initializeApp(firebaseConfig);
      db = firebase.firestore();
    } catch (error) {
      console.error("Firebase 초기화 실패: ", error);
      alert("Firebase 설정을 확인해주세요. firebaseConfig에 올바른 값을 입력했는지 확인하세요.");
    }

    // 경기 정보
    const matches = [
      { time: "600", court: "3", team1: ["최준호", "@기훈"], team2: ["정수현", "김석준"] },
      { time: "600", court: "4", team1: ["권혁이", "김명수"], team2: ["백건재", "강기훈"] },
      { time: "600", court: "6", team1: ["김나경", "김유하"], team2: ["이은지", "이지화"], isWomen: true },
      { time: "600", court: "8", team1: ["상우", "안종현"], team2: ["지민석", "김정보"] },
      { time: "625", court: "3", team1: ["김명수", "안종현"], team2: ["강기훈", "김수동"] },
      { time: "625", court: "5", team1: ["권혁이", "지민석"], team2: ["백건재", "상우"] },
      { time: "625", court: "6", team1: ["박상원", "이범주"], team2: ["정래민", "강동혁"] },
      { time: "625", court: "7", team1: ["정수현", "김석준"], team2: ["전우식", "최준호"] },
      { time: "625", court: "8", team1: ["김덕헌", "@기훈"], team2: ["김정보", "노민영"] },
      { time: "650", court: "4", team1: ["박상원", "정현두"], team2: ["정래민", "백건재"] },
      { time: "650", court: "5", team1: ["@기훈", "강기훈"], team2: ["지민석", "이범주"] },
      { time: "650", court: "6", team1: ["이은지", "남정주"], team2: ["김유하", "최창민"], isWomen: true },
      { time: "650", court: "7", team1: ["김수동", "전우식"], team2: ["강동혁", "노민영"] },
      { time: "650", court: "8", team1: ["김덕헌", "상우"], team2: ["김정보", "김명수"] },
      { time: "715", court: "3", team1: ["김정보", "백건재"], team2: ["지민석", "최준호"] },
      { time: "715", court: "5", team1: ["정래민", "박상원"], team2: ["강동혁", "안종현"] },
      { time: "715", court: "7", team1: ["김석준", "@기훈"], team2: ["정수현", "권혁이"] },
      { time: "715", court: "8", team1: ["이범주", "김덕헌"], team2: ["전우식", "정현두"] },
      { time: "740", court: "3", team1: ["김명수", "정수현"], team2: ["강동혁", "김수동"] },
      { time: "740", court: "4", team1: ["권혁이", "정현두"], team2: ["전우식", "노민영"] },
      { time: "740", court: "6", team1: ["김나경", "이지화"], team2: ["김유하", "최창민"], isWomen: true },
      { time: "740", court: "7", team1: ["최준호", "정래민"], team2: ["박상원", "강기훈"] },
      { time: "805", court: "4", team1: ["정현두", "강기훈"], team2: ["노민영", "전우식"] },
      { time: "805", court: "5", team1: ["정래민", "상우"], team2: ["안종현", "지민석"] },
      { time: "805", court: "6", team1: ["김지원", "이은지"], team2: ["이지화", "최창민"], isWomen: true },
      { time: "830", court: "4", team1: ["강동혁", "김덕헌"], team2: ["상우", "@기훈"] },
      { time: "830", court: "5", team1: ["권혁이", "정수현"], team2: ["정현두", "노민영"] },
      { time: "830", court: "6", team1: ["김지원", "김나경"], team2: ["남정주", "최창민"], isWomen: true },
      { time: "855", court: "4", team1: ["김석준", "김명수"], team2: ["안종현", "김정보"] },
      { time: "855", court: "5", team1: ["이범주", "최준호"], team2: ["김덕헌", "김수동"] },
      { time: "855", court: "6", team1: ["김지원", "이은지"], team2: ["이지화", "남정주"], isWomen: true },
      { time: "920", court: "4", team1: ["박상원", "이범주"], team2: ["백건재", "김석준"] },
      { time: "920", court: "6", team1: ["김지원", "김유하"], team2: ["김나경", "남정주"], isWomen: true },
    ];

    // 선수별 기록 저장
    let menStats = {};
    let womenStats = {};
    let currentFilteredPlayer = null;

    // 초기화
    function initializeStats() {
      const men = ["정래민", "권혁이", "@기훈", "김명수", "김석준", "김수동", "노민영", "백건재", "강동혁", "박상원", "상우", "안종현", "이범주", "전우식", "정수현", "정현두", "지민석", "최준호", "강기훈", "김정보", "김덕헌"];
      const women = ["김나경", "김유하", "이은지", "이지화", "김지원", "남정주", "최창민"];

      men.forEach(player => {
        menStats[player] = { wins: 0, losses: 0, gameDiff: 0 };
      });

      women.forEach(player => {
        womenStats[player] = { wins: 0, losses: 0, gameDiff: 0 };
      });
    }

    // Firestore에서 실시간 스코어 리스너 설정
    function setupRealtimeListeners() {
      if (!db) {
        console.error("Firestore가 초기화되지 않았습니다.");
        return;
      }

      matches.forEach(match => {
        const docRef = db.collection('scores').doc(`${match.time}-${match.court}`);
        docRef.onSnapshot(doc => {
          if (doc.exists) {
            const data = doc.data();
            document.getElementById(`score-${match.time}-${match.court}-team1`).value = data.team1 || 0;
            document.getElementById(`score-${match.time}-${match.court}-team2`).value = data.team2 || 0;
            updateScores();
          }
        });

        // 스코어 입력 시 Firestore에 저장
        const input1 = document.getElementById(`score-${match.time}-${match.court}-team1`);
        const input2 = document.getElementById(`score-${match.time}-${match.court}-team2`);
        [input1, input2].forEach(input => {
          input.addEventListener('change', () => {
            const loadingSpan = document.getElementById(`loading-${match.time}-${match.court}`);
            loadingSpan.textContent = "업데이트 중...";
            loadingSpan.style.display = "block";
            const score1 = parseInt(input1.value) || 0;
            const score2 = parseInt(input2.value) || 0;
            docRef.set({ team1: score1, team2: score2 })
              .then(() => {
                const completedSpan = document.getElementById(`completed-${match.time}-${match.court}`);
                if (score1 !== 0 || score2 !== 0) {
                  completedSpan.textContent = "완료";
                } else {
                  completedSpan.textContent = "";
                }
                loadingSpan.textContent = "저장 완료!";
                setTimeout(() => {
                  loadingSpan.style.display = "none";
                }, 1000);
              })
              .catch(error => {
                console.error("Firestore 저장 실패: ", error);
                loadingSpan.textContent = "저장 실패";
                setTimeout(() => {
                  loadingSpan.style.display = "none";
                }, 1000);
              });
          });
          input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
              e.preventDefault();
              input.dispatchEvent(new Event('change'));
            }
          });
        });
      });
    }

    // 스코어 업데이트 함수
    function updateScores() {
      initializeStats();

      matches.forEach(match => {
        const score1 = parseInt(document.getElementById(`score-${match.time}-${match.court}-team1`).value) || 0;
        const score2 = parseInt(document.getElementById(`score-${match.time}-${match.court}-team2`).value) || 0;

        if (score1 === 0 && score2 === 0) return;

        const stats = match.isWomen ? womenStats : menStats;
        const team1 = match.team1;
        const team2 = match.team2;

        if (score1 > score2) {
          team1.forEach(player => {
            stats[player].wins += 1;
          });
          team2.forEach(player => {
            stats[player].losses += 1;
          });
        } else if (score2 > score1) {
          team2.forEach(player => {
            stats[player].wins += 1;
          });
          team1.forEach(player => {
            stats[player].losses += 1;
          });
        }

        const gameDiff = score1 - score2;
        team1.forEach(player => {
          stats[player].gameDiff += gameDiff;
        });
        team2.forEach(player => {
          stats[player].gameDiff -= gameDiff;
        });
      });

      updateRankings();
    }

    // 순위표 업데이트
    function updateRankings() {
      // 남자 복식 순위표
      let menRankings = Object.entries(menStats).map(([player, stats]) => ({
        player,
        wins: stats.wins,
        losses: stats.losses,
        gameDiff: stats.gameDiff
      }));

      menRankings.sort((a, b) => {
        if (a.wins !== b.wins) return b.wins - a.wins;
        return b.gameDiff - a.gameDiff;
      });

      const menTableBody = document.getElementById("men-doubles-rankings");
      menTableBody.innerHTML = "";
      menRankings.forEach(({ player, wins, losses, gameDiff }, index) => {
        const row = document.createElement("tr");
        let bgColor = '';
        if (index === 0) bgColor = 'background-color: #FFD700;';
        else if (index === 1) bgColor = 'background-color: #C0C0C0;';
        else if (index === 2) bgColor = 'background-color: #CD7F32;';
        row.style = bgColor;
        row.innerHTML = `
          <td>${index + 1}</td>
          <td class="player-name" data-player="${player}" onclick="highlightPlayer('${player}')">${player}</td>
          <td id="wins-${player}">${wins}</td>
          <td id="losses-${player}">${losses}</td>
          <td id="game-diff-${player}">${gameDiff}</td>
        `;
        menTableBody.appendChild(row);
      });

      // 여자 복식 순위표
      let womenRankings = Object.entries(womenStats).map(([player, stats]) => ({
        player,
        wins: stats.wins,
        losses: stats.losses,
        gameDiff: stats.gameDiff
      }));

      womenRankings.sort((a, b) => {
        if (a.wins !== b.wins) return b.wins - a.wins;
        return b.gameDiff - a.gameDiff;
      });

      const womenTableBody = document.getElementById("women-doubles-rankings");
      womenTableBody.innerHTML = "";
      womenRankings.forEach(({ player, wins, losses, gameDiff }, index) => {
        const row = document.createElement("tr");
        let bgColor = '';
        if (index === 0) bgColor = 'background-color: #FFD700;';
        else if (index === 1) bgColor = 'background-color: #C0C0C0;';
        else if (index === 2) bgColor = 'background-color: #CD7F32;';
        row.style = bgColor;
        row.innerHTML = `
          <td>${index + 1}</td>
          <td class="player-name" data-player="${player}" onclick="highlightPlayer('${player}')">${player}</td>
          <td id="wins-${player}">${wins}</td>
          <td id="losses-${player}">${losses}</td>
          <td id="game-diff-${player}">${gameDiff}</td>
        `;
        womenTableBody.appendChild(row);
      });
    }

    // 선수 하이라이트 및 필터링 함수
    function highlightPlayer(playerName) {
      currentFilteredPlayer = playerName;
      const tables = [document.getElementById('schedule-table-1'), document.getElementById('schedule-table-2')];
      const clearButton = document.getElementById('clear-filter');

      // 모든 행 초기화
      tables.forEach(table => {
        const rows = table.querySelectorAll('tbody tr');
        rows.forEach(row => {
          row.classList.add('hidden');
          const matchCells = row.querySelectorAll('.match-pair');
          matchCells.forEach(cell => cell.classList.remove('highlight'));
        });
      });

      // matches 배열 기반으로 필터링
      let hasMatches = false;
      matches.forEach(match => {
        const players = [...match.team1, ...match.team2];
        if (players.includes(playerName)) {
          const tableId = match.time < "805" ? 'schedule-table-1' : 'schedule-table-2';
          const table = document.getElementById(tableId);
          const rows = table.querySelectorAll('tbody tr');
          
          // 시간 매핑
          const timeMap = {
            "600": "6:00~6:25",
            "625": "6:25~6:50",
            "650": "6:50~7:15",
            "715": "7:15~7:40",
            "740": "7:40~8:05",
            "805": "8:05~8:30",
            "830": "8:30~8:55",
            "855": "8:55~9:20",
            "920": "9:20~9:45"
          };
          const expectedTime = timeMap[match.time];

          rows.forEach(row => {
            const timeCell = row.querySelector('td:first-child');
            if (timeCell && timeCell.textContent.trim() === expectedTime) {
              // 코트 인덱스 계산 (schedule-table-1: 3~8, schedule-table-2: 4~8)
              const courtIndex = tableId === 'schedule-table-1' 
                ? parseInt(match.court) - 2  // 3번 코트 -> td:nth-child(2)
                : parseInt(match.court) - 3; // 4번 코트 -> td:nth-child(2)
              const matchCell = row.querySelector(`td:nth-child(${courtIndex + 1}) .match-pair`);
              if (matchCell) {
                row.classList.remove('hidden');
                matchCell.classList.add('highlight');
                hasMatches = true;
                console.log(`Match found: ${playerName} at ${expectedTime}, court ${match.court}`);
              }
            }
          });
        }
      });

      // 필터 버튼 표시
      if (hasMatches) {
        clearButton.classList.remove('hidden');
      } else {
        clearButton.classList.add('hidden');
        console.log(`No matches found for ${playerName}`);
      }
    }

    // 필터 해제 함수
    function clearFilter() {
      currentFilteredPlayer = null;
      const tables = [document.getElementById('schedule-table-1'), document.getElementById('schedule-table-2')];
      const clearButton = document.getElementById('clear-filter');

      tables.forEach(table => {
        const rows = table.querySelectorAll('tbody tr');
        rows.forEach(row => {
          row.classList.remove('hidden');
          const matchCell = row.querySelector('.match-pair');
          if (matchCell) matchCell.classList.remove('highlight');
        });
      });

      clearButton.classList.add('hidden');
    }

    // 이벤트 리스너 추가
    document.getElementById('clear-filter').addEventListener('click', clearFilter);

    // 초기화 및 리스너 설정
    initializeStats();
    setupRealtimeListeners();
  </script>
</body>
</html>